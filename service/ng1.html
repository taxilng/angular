<!DOCTYPE html>
<html ng-app="myModule">
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
  <div ng-controller="myCtrl">
      <label>用户名</label>
      <input type="text" ng-model="username" placeholder="请输入用户名">

  </div>
</body>
<script src="../angular-1.6.8/angular.js"></script>
<script>
var myModule = angular.module('myModule',[]);

myModule.controller('myCtrl',['$scope','$timeout',function($scope, $timeout){
     var timeout;
     $scope.$watch('username',function(newUserName){
         
         
         if(newUserName){
            //  if(timeout){
                 $timeout.cancel(timeout);
            //  }
            console.log("hhhhh");
            console.log(timeout);
             timeout = $timeout(function(){
                 console.log("哈哈");
                 
             },500
             )
         }
     }
     )
}])

myModule.run(function($timeout){
          var a = $timeout(function(){
              console.log('执行$timeout回调');
              return 'angular'
          },1000);
          a.then(function(data){
              console.log(data)
          },function(data){
              console.log(data)
          });
          $timeout.cancel(a);
      })

</script>
</html>